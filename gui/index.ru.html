<html>
<head>
<link rel="stylesheet" href="static/css/bootstrap.min.css">
<link rel="stylesheet" href="static/css/bootflat.min.css">
% if action == 'running':
    <meta http-equiv="refresh" content="5; URL=/check">
% end
</head>
<body style="background-color: #f1f2f6;">
    <div class="container-fluid">
        <div class="row">
            <div class="well">
                <img src="static/logo.png" />
            </div>
        </div>

        % if action == 'start':
            % include('languages.html', language=language)

            % if connection:
                <div class="alert alert-warning"><strong>ВНИМАНИЕ!</strong> Вы подключены к Интернету. Во время этого 

теста Вы должны быть отключены от любой сети, будь то кабельная или беспроводная.</div>
            % end

            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title"><strong>Что это такое?</strong></h3>
                </div>
                <div class="panel-body">
                    Эта простая программа пытается выявить потенциальное заражение Вашего компьютера шпионскими 

программами.
                    При запуске программа будет искать определенные индикаторы в памяти. Если у Вас есть какие-то 

запущенные приложения (например, Skype, браузер и т.д.), пожалуйста, закройте их, чтобы повысить 

производительность и снизить шансы ложных срабатываний. Это займет несколько минут, пожайлуста будьте 

терпеливы.
                </div>
            </div>

            <p>
                <a class="btn btn-lg btn-primary btn-block" href="/scan">Сканировать!</a>
            </p>
        % end

        % if action == 'running':
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title"><strong>Сканирует...</strong></h3>
                </div>
                <div class="panel-body">
                    <p>Сканирование в процессе. Это может занять несколько минут. Пожайлуста будьте терпеливы и не 

прерывайте работу приложения до окончания.
                    <div class="progress progress-striped active">
                        <div class="progress-bar" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" 

style="width: 100%"></div>
                    </div>
                    <p style="text-align: center;"><a href="/check">Обновить</a><br /><small>Автоматически должен обновляться 

каждые 5 секунд</small></p>
                </div>
            </div>
        % end

        % if action == 'results':
            % if errors:
                <div class="alert alert-warning">
                    <h4>ВНИМАНИЕ!</h4>
                    Некоторые <strong>ошибки были найдены</strong>, которые могут повлиять на результат сканирования:
                    <ul>
                        % for error in errors:
                            % if error == 'NOT_AN_ADMIN':
                                <li>Вы должны запустить программу с правами Администратора!</li>
                            % elif error == 'UNSUPPORTED_WINDOWS':
                                <li>Вы используете неподдерживаемую версию системы Microsoft Windows.</li>
                            % elif error == 'NO_DRIVER':
                                <li>Подходящий драйвер для использования не найден.</li>
                            % elif error == 'SERVICE_NO_START':
                                <li>Не удается запустить сервис, попробуйте перезапустить приложение или компьютер, если это не 

помогло.</li>
                            % elif error == 'SCAN_FAILED':
                                <li>Сканирование не удалось, попробуйте переустановить программу. Если это не помогает, то 

предоставьте лог файлы по контакту для исследования возникшей проблемы.</li>
                            % end
                        % end
                    </ul>
                </div>
            % else:
                % if infected:
                    <div class="alert alert-danger">
                        <h4>ОПАСНОСТЬ!</h4>
                        <strong>Мне удалось выявить потенциальное присутствие шпионского ПО!</strong> Вы должны 

выключить компьютер, не подключайте его снова к Интернету или любого внешнего устройства и обратитесь за 

помощью.<br /><br />
                        Для дальнейших инструкций и связи с нами посетите 
<b>https://www.resistsurveillance.org/emergency</b>
                    </div>

                    <p>Вот что было обнаружено:</p>
                    <ul>
                        % for detection in results:
                            <li><strong>{{detection}}</strong><br />
                            % if detection == 'BlackShades RAT':
                                Это распространенный троян, который доступен любому для бесплатного скачивания из Интернета. 

Основные антивирусные программы должны обнаруживать этот троян и помещать в карантин. Хоть и невозможно 

установить для кого вы являетесь целью, тем не менее стоит обратиться за помощью.
                            
                            % elif detection == 'DarkComet RAT':
                                Это распространенный троян, который доступен любому для бесплатного скачивания из Интернета. 

Основные антивирусные программы должны обнаруживать этот троян и помещать в карантин. Хоть и невозможно 

установить для кого вы являетесь целью, тем не менее стоит обратиться за помощью.

                            % elif detection == 'FinFisher FinSpy':
                                Это очень сложный бэкдор разработанный немецкой компанией и продается правительственным 

учреждениям по всему миру. Вы можете быть целью вашего или иностранного правительств. Вы должны быть очень 

осторожны в своих последующих шагах для того, чтобы далее не усугублять вашу ситуацию.

                            % elif detection == 'Gh0st':
                                Это распространенный троян, который доступен любому для бесплатного скачивания из Интернета. 

Основные антивирусные программы должны обнаруживать этот троян и помещать в карантин. Хоть и невозможно 

установить для кого вы являетесь целью, тем не менее стоит обратиться за помощью.

                            % elif detection == 'Njrat':
                                Это распространенный троян, который доступен любому для бесплатного скачивания из Интернета. 

Основные антивирусные программы должны обнаруживать этот троян и помещать в карантин. Хоть и невозможно 

установить для кого вы являетесь целью, тем не менее стоит обратиться за помощью.

                            % elif detection == 'Hacking Team RCS Scout' or detection == 'Hacking Team RCS Backdoor':
                                Это очень сложный бэкдор разработанный итальянской компанией и продается правительственным 

учреждениям по всему миру. Вы можете быть целью вашего или иностранного правительств. Вы должны быть очень 

осторожны в своих последующих шагах для того, чтобы далее не усугублять вашу ситуацию.

                            % elif detection == 'ShadowTech RAT':
                                Это распространенный троян, который доступен любому для бесплатного скачивания из Интернета. 

Основные антивирусные программы должны обнаруживать этот троян и помещать в карантин. Хоть и невозможно 

установить для кого вы являетесь целью, тем не менее стоит обратиться за помощью.

                            % elif detection == 'Xtreme RAT':
                                Это распространенный троян, который доступен любому для бесплатного скачивания из Интернета. 

Основные антивирусные программы должны обнаруживать этот троян и помещать в карантин. Хоть и невозможно 

установить для кого вы являетесь целью, тем не менее стоит обратиться за помощью.
                            % end
                            </li>
                        % end
                    </ul>
                % else:
                    <div class="alert alert-success">
                        <h4>Looks good.</h4>
                        Я не смог обнаружить наличие какой-либо шпионской программы. Пожалуйста, обратите внимание, что 

это не обязательно означает, что ваш компьютер чист. Если у Вас сильное подозрение того что Вы являетесь целью, 

пожайлуста, обратитесь за помощью.<br /><br />
                        Дополнительную информацию можете найти на <b>https://www.resistsurveillance.org/emergency</b>
                    </div>
                % end
            % end
        % end
    </div>
</body>
</html>
